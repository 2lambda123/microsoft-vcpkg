diff --git a/clickhouse/base/socket.cpp b/clickhouse/base/socket.cpp
index a11cd2f..838b0aa 100644
--- a/clickhouse/base/socket.cpp
+++ b/clickhouse/base/socket.cpp
@@ -1,3 +1,7 @@
+#ifndef UNICODE
+#define UNICODE
+#endif
+
 #include "socket.h"
 #include "singleton.h"
 #include "../client.h"
@@ -26,8 +30,8 @@ char const* windowsErrorCategory::name() const noexcept {
 }
 
 std::string windowsErrorCategory::message(int c) const {
-    char error[UINT8_MAX];
-    auto len = FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, nullptr, static_cast<DWORD>(c), 0, error, sizeof(error), nullptr);
+    wchar_t error[UINT8_MAX];
+    auto len = FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, nullptr, Lstatic_cast<DWORD>(c), 0, error, Lsizeof(error), nullptr);
     if (len == 0) {
         return "unknown";
     }

diff --git a/src/libmongoc/CMakeLists.txt b/src/libmongoc/CMakeLists.txt
index 3070c43..807ef8c 100644
--- a/src/libmongoc/CMakeLists.txt
+++ b/src/libmongoc/CMakeLists.txt
@@ -820,7 +820,7 @@ set_property(
    "MONGOC_CYRUS_PLUGIN_PATH_PREFIX=$<IF:$<STREQUAL:${CYRUS_PLUGIN_PATH_PREFIX},>,NULL,\"${CYRUS_PLUGIN_PATH_PREFIX}\">"
 )
 
-if (ENABLE_SHARED)
+if (NOT MONGOC_ENABLE_STATIC_BUILD)
    add_library (mongoc_shared SHARED ${SOURCES} ${HEADERS} ${HEADERS_FORWARDING})
    if(WIN32)
       # Add resource-definition script for Windows shared library (.dll).
@@ -1093,6 +1093,7 @@ set (test-libmongoc-sources
    ${PROJECT_SOURCE_DIR}/tests/unified/util.c
 )
 
+if(NOT MONGOC_ENABLE_STATIC_INSTALL)
 if (MONGOC_ENABLE_SSL)
    set (test-libmongoc-sources ${test-libmongoc-sources}
       ${PROJECT_SOURCE_DIR}/tests/ssl-test.c
@@ -1262,7 +1263,7 @@ if (MONGOC_ENABLE_STATIC_INSTALL)
    list (APPEND TARGETS_TO_INSTALL mongoc_static)
 endif ()
 
-if (ENABLE_SHARED)
+if (NOT MONGOC_ENABLE_STATIC_BUILD)
    list (APPEND TARGETS_TO_INSTALL mongoc_shared)
 endif ()
 
@@ -1327,6 +1328,7 @@ if (MONGOC_ENABLE_SSL)
       DESTINATION ${CMAKE_INSTALL_LIBDIR}/pkgconfig
    )
 endif ()
+endif ()
 
 include (CMakePackageConfigHelpers)
 

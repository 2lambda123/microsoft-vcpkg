From 114471d6cfbb475e68c86b775f4f39316a1d6b10 Mon Sep 17 00:00:00 2001
From: JacobBarthelmeh <jacob@wolfssl.com>
Date: Tue, 3 Jan 2023 15:23:43 -0800
Subject: [PATCH 1/2] add pragram around sanity check for vcpkg build warning

---
 src/internal.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/src/internal.c b/src/internal.c
index 1afa361f9d0..c17158b34cd 100644
--- a/src/internal.c
+++ b/src/internal.c
@@ -12781,9 +12781,17 @@ static int ProcessPeerCertParse(WOLFSSL* ssl, ProcPeerCertArgs* args,
         return BAD_FUNC_ARG;
     }
 
+PRAGMA_GCC_DIAG_PUSH
+PRAGMA_GCC("GCC diagnostic ignored \"-Wstrict-overflow\"")
+    /* Surrounded in gcc pragma to avoid -Werror=strict-overflow when the
+     * compiler optimizes out the check and assumes no underflow. Keeping the
+     * check in place to handle multiple build configurations and future
+     * changes. */
+
     /* check to make sure certificate index is valid */
     if (args->certIdx > args->count)
         return BUFFER_E;
+PRAGMA_GCC_DIAG_POP
 
     /* check if returning from non-blocking OCSP */
     /* skip this section because cert is already initialized and parsed */

From d5a7b5633274818c95ac7a2d17e1fa15e3cebc26 Mon Sep 17 00:00:00 2001
From: JacobBarthelmeh <jacob@wolfssl.com>
Date: Wed, 4 Jan 2023 16:19:27 -0800
Subject: [PATCH 2/2] sp pragram around sanity check for vcpkg build warning

---
 wolfcrypt/src/sp_int.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/wolfcrypt/src/sp_int.c b/wolfcrypt/src/sp_int.c
index b5199ed7352..cbff871f08a 100644
--- a/wolfcrypt/src/sp_int.c
+++ b/wolfcrypt/src/sp_int.c
@@ -4822,6 +4822,10 @@ int sp_copy(const sp_int* a, sp_int* r)
     }
     /* Only copy if different pointers. */
     else if (a != r) {
+    PRAGMA_GCC_DIAG_PUSH
+    PRAGMA_GCC("GCC diagnostic ignored \"-Wstrict-overflow\"")
+    /* Surrounded in gcc pragma to avoid -Werror=strict-overflow when the
+     * compiler optimizes out the check and assumes no overflow. */
         /* Validated space in result. */
         if (a->used > r->size) {
             err = MP_VAL;
@@ -4841,6 +4845,7 @@ int sp_copy(const sp_int* a, sp_int* r)
             r->sign = a->sign;
         #endif
         }
+    PRAGMA_GCC_DIAG_POP
     }
 
     return err;

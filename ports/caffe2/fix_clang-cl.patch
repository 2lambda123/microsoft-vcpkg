diff --git a/cmake/Utils.cmake b/cmake/Utils.cmake
index e04ed97e8..5901551f4 100644
--- a/cmake/Utils.cmake
+++ b/cmake/Utils.cmake
@@ -382,7 +382,7 @@ function(caffe_detect_darwin_version output_var)
 endfunction()
 
 function(caffe_add_whole_archive_flag lib output_var)
-  if("${CMAKE_CXX_COMPILER_ID}" MATCHES "Clang")
+  if("${CMAKE_CXX_COMPILER_ID}" MATCHES "Clang" AND NOT MSVC)
     set(${output_var} -Wl,-force_load,$<TARGET_FILE:${lib}> PARENT_SCOPE)
   elseif(MSVC)
     # In MSVC, we will add whole archive in default.

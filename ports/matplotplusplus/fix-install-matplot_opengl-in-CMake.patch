From dd13066ec929ded9ee008d33d6939b3bcb2b7ad7 Mon Sep 17 00:00:00 2001
From: Amin Yahyaabadi <aminyahyaabadi74@gmail.com>
Date: Wed, 3 May 2023 02:29:00 -0700
Subject: [PATCH] fix: install matplot_opengl in CMake

---
 source/matplot/CMakeLists.txt | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/source/matplot/CMakeLists.txt b/source/matplot/CMakeLists.txt
index 797d3f2..fe9ad53 100644
--- a/source/matplot/CMakeLists.txt
+++ b/source/matplot/CMakeLists.txt
@@ -90,6 +90,8 @@ add_library(matplot
         freestanding/plot.h
 )
 
+set(TARGETS matplot)
+
 # Target aliases
 add_library(Matplot++::matplot ALIAS matplot)
 add_library(Matplot++::matplot++ ALIAS matplot)
@@ -220,7 +222,7 @@ if (MATPLOTPP_BUILD_EXPERIMENTAL_OPENGL_BACKEND)
         # Use CPM only if not found, to avoid ODR violations
         # find_package(GLAD REQUIRE) would suffice if it worked well
         FetchContent_Declare(glad GIT_REPOSITORY https://github.com/Dav1dde/glad.git GIT_TAG df8e9e16110b305479a875399cee13daa0ccadd9)
-        FetchContent_MakeAvailable(glad)        
+        FetchContent_MakeAvailable(glad)
     else ()
         # FindGLAD does not usually create a target, so we create an interface target
         if (NOT TARGET glad)
@@ -245,8 +247,9 @@ if (MATPLOTPP_BUILD_EXPERIMENTAL_OPENGL_BACKEND)
             backend/opengl.h
             backend/opengl.cpp
             )
-    target_include_directories(matplot_opengl PUBLIC matplot)
     target_link_libraries(matplot_opengl PUBLIC matplot glad glfw ${CMAKE_DL_LIBS})
+
+    list(APPEND TARGETS matplot_opengl)
 endif()
 
 #######################################################
@@ -254,7 +257,7 @@ endif()
 #######################################################
 if (MATPLOTPP_BUILD_INSTALLER)
     # Install targets
-    install(TARGETS matplot
+    install(TARGETS ${TARGETS}
             EXPORT Matplot++Targets
 	    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
             LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
-- 
2.34.1


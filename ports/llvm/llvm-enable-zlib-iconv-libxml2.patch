diff --git a/cmake/config-ix.cmake b/cmake/config-ix.cmake
index b4b0c1f..c98c364 100644
--- a/cmake/config-ix.cmake
+++ b/cmake/config-ix.cmake
@@ -130,17 +130,14 @@ endif()
 # Don't look for these libraries if we're using MSan, since uninstrumented third
 # party code may call MSan interceptors like strlen, leading to false positives.
 if(NOT LLVM_USE_SANITIZER MATCHES "Memory.*")
-  set(HAVE_LIBZ 0)
-  if(LLVM_ENABLE_ZLIB)
-    foreach(library z zlib_static zlib)
-      string(TOUPPER ${library} library_suffix)
-      check_library_exists(${library} compress2 "" HAVE_LIBZ_${library_suffix})
-      if(HAVE_LIBZ_${library_suffix})
-        set(HAVE_LIBZ 1)
-        set(ZLIB_LIBRARIES "${library}")
-        break()
-      endif()
-    endforeach()
+  set(HAVE_LIBZ 0)
+  if (LLVM_ENABLE_ZLIB AND ZLIB_LIBRARY_PATH)
+    find_library(ZLIB_LIBRARY_PATH NAMES z zlib)
+    include_directories(${ZLIB_INCLUDE_DIRS})
+  	 check_library_exists(${ZLIB_LIBRARY_PATH} compress2 "" HAVE_LIBZ)
+    if (HAVE_LIBZ)
+      set(ZLIB_LIBRARIES "${ZLIB_LIBRARIES}")
+    endif()
   endif()
 
   # Don't look for these libraries on Windows.
@@ -165,17 +159,17 @@ if(NOT LLVM_USE_SANITIZER MATCHES "Memory.*")
     else()
       set(HAVE_TERMINFO 0)
     endif()
+  endif()
 
-    find_library(ICONV_LIBRARY_PATH NAMES iconv libiconv libiconv-2 c)
-    set(LLVM_LIBXML2_ENABLED 0)
-    set(LIBXML2_FOUND 0)
-    if((LLVM_ENABLE_LIBXML2) AND ((CMAKE_SYSTEM_NAME MATCHES "Linux") AND (ICONV_LIBRARY_PATH) OR APPLE))
-      find_package(LibXml2)
-      if (LIBXML2_FOUND)
-        set(LLVM_LIBXML2_ENABLED 1)
-        include_directories(${LIBXML2_INCLUDE_DIR})
-        set(LIBXML2_LIBS "xml2")
-      endif()
+  find_library(ICONV_LIBRARY_PATH NAMES iconv libiconv libiconv-2 c)
+  set(LLVM_LIBXML2_ENABLED 0)
+  set(LIBXML2_FOUND 0)
+  if((LLVM_ENABLE_LIBXML2) AND ((ICONV_LIBRARY_PATH) OR APPLE))
+    find_package(LibXml2)
+    if (LIBXML2_FOUND)
+      set(LLVM_LIBXML2_ENABLED 1)
+      include_directories(${LIBXML2_INCLUDE_DIR})
+      set(LIBXML2_LIBS "${LIBXML2_LIBRARIES}")
     endif()
   endif()
 endif()

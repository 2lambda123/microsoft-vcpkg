diff --git a/CMakeLists.txt b/CMakeLists.txt
index 1ce72325d..2d52e78f3 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -34,7 +34,7 @@ set(CMAKE_CXX_STANDARD_REQUIRED ON)
 set(CMAKE_CXX_EXTENSIONS OFF)
 message(STATUS "nanodbc compile: C++${CMAKE_CXX_STANDARD}")
 
-if(CMAKE_CXX_COMPILER_ID MATCHES "Clang" OR CMAKE_COMPILER_IS_GNUCXX)
+if(CMAKE_CXX_COMPILER_ID MATCHES "Clang" OR CMAKE_COMPILER_IS_GNUCXX AND NOT MSVC)
   set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Werror")
   include(CheckCXXCompilerFlag)
 
@@ -68,7 +68,7 @@ elseif(CMAKE_CXX_COMPILER_ID MATCHES "Intel")
 elseif(MSVC)
   string(REGEX REPLACE "/W[0-4]" "/W4" CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
   if(MSVC_VERSION LESS 1700)
-    message(FATAL_ERROR, "nanodbc requires C++11-compliant compiler")
+    message(FATAL_ERROR "nanodbc requires C++11-compliant compiler")
   endif()
 endif()
 

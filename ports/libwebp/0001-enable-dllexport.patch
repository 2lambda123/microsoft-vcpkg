diff --git a/CMakeLists.txt b/CMakeLists.txt
index 499ddce..5d5e033 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -159,6 +159,9 @@ add_definitions(-DHAVE_CONFIG_H)
 if(MSVC)
   # avoid security warnings for e.g., fopen() used in the examples.
   add_definitions(-D_CRT_SECURE_NO_WARNINGS)
+  if(BUILD_SHARED_LIBS)
+    add_definitions(-DWEBP_EXTERN=__declspec\(dllexport\))
+  endif()
 else()
   add_definitions(-Wall)
 endif()

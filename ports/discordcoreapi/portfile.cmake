if (UNIX)
	set(CMAKE_CXX_COMPILER "/usr/bin/x86_64-linux-gnu-g++-11")
	set(CMAKE_C_COMPILER "/usr/bin/gcc-11")
endif()
vcpkg_from_github(
	OUT_SOURCE_PATH SOURCE_PATH
	REPO RealTimeChris/DiscordCoreAPI
	REF b59200d7709f6662a1df35391dd4f663c73e5b28
	SHA512 16678884b57445351eb66beb7875cb4dac67367b664d72f367ee5c98e896ea01ee9067e04a6a76c72d360aed54d3f9b75e25dfb5c16f478be8e1807f9498068e
	HEAD_REF main
)


vcpkg_cmake_install()

add_subdirectory(Executable/Library)
install(TARGETS DiscordCoreAPI CONFIGURATIONS Debug RUNTIME DESTINATION "${CMAKE_INSTALL_PREFIX}/bin" PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_PREFIX}/include/discordcoreapi")
install(TARGETS DiscordCoreAPI CONFIGURATIONS Release RUNTIME DESTINATION "${CMAKE_INSTALL_PREFIX}/bin" PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_PREFIX}/include/discordcoreapi")
install(TARGETS DiscordCoreAPI CONFIGURATIONS Debug ARCHIVE DESTINATION "${CMAKE_INSTALL_PREFIX}/lib" PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_PREFIX}/include/discordcoreapi")
install(TARGETS DiscordCoreAPI CONFIGURATIONS Release ARCHIVE DESTINATION "${CMAKE_INSTALL_PREFIX}/lib" PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_PREFIX}/include/discordcoreapi")
install(FILES $<$<PLATFORM_ID:Windows>:$<TARGET_PDB_FILE:DiscordCoreAPI>> DESTINATION "${CMAKE_INSTALL_PREFIX}/bin" OPTIONAL)
file(REMOVE_RECURSE "${CURRENT_PACKAGES_DIR}/debug/bin" "${CURRENT_PACKAGES_DIR}/bin")
file(REMOVE_RECURSE "${CURRENT_PACKAGES_DIR}/debug/include")

file(
	INSTALL "${SOURCE_PATH}/License"
	DESTINATION "${CURRENT_PACKAGES_DIR}/share/${PORT}"
	RENAME copyright
)

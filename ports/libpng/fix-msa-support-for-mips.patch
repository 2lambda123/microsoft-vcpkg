diff --git a/CMakeLists.txt b/CMakeLists.txt
index 6c1d632..8bd9aa9 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -173,6 +173,10 @@ if(CMAKE_SYSTEM_PROCESSOR MATCHES "mipsel*" OR
       mips/filter_msa_intrinsics.c)
     if(${PNG_MIPS_MSA} STREQUAL "on")
       add_definitions(-DPNG_MIPS_MSA_OPT=2)
+      if("${CMAKE_C_COMPILER_VERSION}" VERSION_GREATER_EQUAL "7")
+        add_definitions(-D__mips_msa)
+        add_compile_options(-mmsa -mhard-float -mfp64)
+      endif()
     endif()
   else()
     add_definitions(-DPNG_MIPS_MSA_OPT=0)

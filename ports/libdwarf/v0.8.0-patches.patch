diff --git a/CMakeLists.txt b/CMakeLists.txt
index 28076ee4..68583f92 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -193,77 +193,81 @@ check_c_source_compiles([=[
   }]=] HAVE_STDAFX_H)
 #message(STATUS "Checking have windows stdafx.h... ${HAVE_STDAFX_H}")
 
-set(CMAKE_REQUIRED_LIBRARIES z)
-check_c_source_compiles( [=[
-  #include "zlib.h"
-  int main()
-  {
-      Bytef dest[100];
-      uLongf destlen = 100;
-      Bytef *src = 0;
-      uLong srclen = 3;
-      int res = uncompress(dest,&destlen,src,srclen);
-      if (res == Z_OK) {
-           /* ALL IS WELL */
-      }
-      return 0;
-  } ]=]  HAVE_ZLIB )
-check_c_source_compiles( [=[
-  #include "zlib.h"
-  int main()
-  {
-      Bytef dest[100];
-      uLongf destlen = 100;
-      Bytef *src = 0;
-      uLong srclen = 3;
-      int res = uncompress(dest,&destlen,src,srclen);
-      if (res == Z_OK) {
-           /* ALL IS WELL */
-      }
-      return 0;
-  } ]=]  HAVE_ZLIB_H )
-set(CMAKE_REQUIRED_LIBRARIES)
-if (HAVE_ZLIB) 
-  # For linking in libz
-  set(DW_FZLIB "z")
-endif()
-
-set(CMAKE_REQUIRED_LIBRARIES zstd )
-check_c_source_compiles( [=[
-  #include "zstd.h"
-  int main()
-  {
-      char * dest[100];
-      size_t destlen = 100;
-      char *src = 0;
-      size_t srclen = 3;
-      size_t res = ZSTD_decompress(dest,destlen,src,srclen);
-      if (res == destlen) {
-           /* ALL IS WELL */
-      }
-      return 0;
-  } ]=]  HAVE_ZSTD )
-check_c_source_compiles( [=[
-  #include "zstd.h"
-  int main()
-  {
-      char * dest[100];
-      size_t destlen = 100;
-      char *src = 0;
-      size_t srclen = 3;
-      size_t res = ZSTD_decompress(dest,destlen,src,srclen);
-      if (res == destlen) {
-           /* ALL IS WELL */
-      }
-      return 0;
-  } ]=]  HAVE_ZSTD_H )
-set(CMAKE_REQUIRED_LIBRARIES)
-if (HAVE_ZSTD)
-  # For linking in libzstd
-  set(DW_FZSTD "zstd")
-endif()
-
-
+# set(CMAKE_REQUIRED_LIBRARIES z)
+# check_c_source_compiles( [=[
+#   #include "zlib.h"
+#   int main()
+#   {
+#       Bytef dest[100];
+#       uLongf destlen = 100;
+#       Bytef *src = 0;
+#       uLong srclen = 3;
+#       int res = uncompress(dest,&destlen,src,srclen);
+#       if (res == Z_OK) {
+#            /* ALL IS WELL */
+#       }
+#       return 0;
+#   } ]=]  HAVE_ZLIB )
+# check_c_source_compiles( [=[
+#   #include "zlib.h"
+#   int main()
+#   {
+#       Bytef dest[100];
+#       uLongf destlen = 100;
+#       Bytef *src = 0;
+#       uLong srclen = 3;
+#       int res = uncompress(dest,&destlen,src,srclen);
+#       if (res == Z_OK) {
+#            /* ALL IS WELL */
+#       }
+#       return 0;
+#   } ]=]  HAVE_ZLIB_H )
+# set(CMAKE_REQUIRED_LIBRARIES)
+# if (HAVE_ZLIB) 
+#   # For linking in libz
+#   set(DW_FZLIB "z")
+# endif()
+
+# set(CMAKE_REQUIRED_LIBRARIES zstd )
+# check_c_source_compiles( [=[
+#   #include "zstd.h"
+#   int main()
+#   {
+#       char * dest[100];
+#       size_t destlen = 100;
+#       char *src = 0;
+#       size_t srclen = 3;
+#       size_t res = ZSTD_decompress(dest,destlen,src,srclen);
+#       if (res == destlen) {
+#            /* ALL IS WELL */
+#       }
+#       return 0;
+#   } ]=]  HAVE_ZSTD )
+# check_c_source_compiles( [=[
+#   #include "zstd.h"
+#   int main()
+#   {
+#       char * dest[100];
+#       size_t destlen = 100;
+#       char *src = 0;
+#       size_t srclen = 3;
+#       size_t res = ZSTD_decompress(dest,destlen,src,srclen);
+#       if (res == destlen) {
+#            /* ALL IS WELL */
+#       }
+#       return 0;
+#   } ]=]  HAVE_ZSTD_H )
+# set(CMAKE_REQUIRED_LIBRARIES)
+# if (HAVE_ZSTD)
+#   # For linking in libzstd
+#   set(DW_FZSTD "zstd")
+# endif()
+
+find_package(ZLIB REQUIRED)
+add_library(z ALIAS ZLIB::ZLIB)
+set(DW_FZLIB "z")
+set(HAVE_ZLIB TRUE)
+set(HAVE_ZLIB_H TRUE)
 
 check_c_source_compiles([=[
 #include <stdint.h>
@@ -333,7 +337,7 @@ else()
 endif()
 
 add_subdirectory(src/lib/libdwarf)
-add_subdirectory(src/bin/dwarfdump)
+# add_subdirectory(src/bin/dwarfdump)
 
 if ( BUILD_DWARFEXAMPLE )
 	add_subdirectory(src/bin/dwarfexample)
diff --git a/src/bin/dwarfdump/CMakeLists.txt b/src/bin/dwarfdump/CMakeLists.txt
index 1b8aa3ae..72819160 100644
--- a/src/bin/dwarfdump/CMakeLists.txt
+++ b/src/bin/dwarfdump/CMakeLists.txt
@@ -65,7 +65,7 @@ target_compile_options(dwarfdump PRIVATE ${DW_FWALL})
 
 target_link_libraries(dwarfdump PRIVATE ${dwarf-target} ${DW_FZLIB} ${DW_FZSTD} ) 
 
-if(${CMAKE_SIZEOF_VOID_P} EQUAL 8)
+if(0)
 	set(SUFFIX 64)
 endif()
 set(LIBDIR lib${SUFFIX})
diff --git a/src/lib/libdwarf/CMakeLists.txt b/src/lib/libdwarf/CMakeLists.txt
index 09908bba..91a14479 100644
--- a/src/lib/libdwarf/CMakeLists.txt
+++ b/src/lib/libdwarf/CMakeLists.txt
@@ -109,7 +109,6 @@ foreach(i RANGE ${targetCount})
 	
 	set_target_properties(${target} PROPERTIES OUTPUT_NAME dwarf)
 
-	set(SUFFIX $<$<EQUAL:${CMAKE_SIZEOF_VOID_P},8>:64>)
 	set(LIBDIR lib${SUFFIX})
 	set(BINDIR bin${SUFFIX})
 
diff --git a/src/lib/libdwarf/libdwarf_private.h b/src/lib/libdwarf/libdwarf_private.h
index b37ae994..7fa89256 100644
--- a/src/lib/libdwarf/libdwarf_private.h
+++ b/src/lib/libdwarf/libdwarf_private.h
@@ -26,11 +26,7 @@
 #ifdef _MSC_VER /* Macro to select VS compiler */
 #include <windows.h>
 typedef SSIZE_T ssize_t;
-#ifdef _WIN64
-typedef long long off_t;
-#else
 typedef long off_t;
-#endif
 #endif /* _MSC_VER */
 
 #ifndef TRUE

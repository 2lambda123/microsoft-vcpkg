diff --git a/CMakeLists.txt b/CMakeLists.txt
index 28076ee4..fc74832b 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -193,6 +193,7 @@ check_c_source_compiles([=[
   }]=] HAVE_STDAFX_H)
 #message(STATUS "Checking have windows stdafx.h... ${HAVE_STDAFX_H}")

+if(0)
 set(CMAKE_REQUIRED_LIBRARIES z)
 check_c_source_compiles( [=[
   #include "zlib.h"
@@ -262,8 +263,13 @@ if (HAVE_ZSTD)
   # For linking in libzstd
   set(DW_FZSTD "zstd")
 endif()
+endif()

-
+find_package(ZLIB REQUIRED)
+add_library(z ALIAS ZLIB::ZLIB)
+set(DW_FZLIB "z")
+set(HAVE_ZLIB TRUE)
+set(HAVE_ZLIB_H TRUE)

 check_c_source_compiles([=[
 #include <stdint.h>
@@ -333,7 +339,7 @@ else()
 endif()

 add_subdirectory(src/lib/libdwarf)
-add_subdirectory(src/bin/dwarfdump)
+# add_subdirectory(src/bin/dwarfdump)

 if ( BUILD_DWARFEXAMPLE )
 	add_subdirectory(src/bin/dwarfexample)
diff --git a/src/bin/dwarfdump/CMakeLists.txt b/src/bin/dwarfdump/CMakeLists.txt
index 1b8aa3ae..72819160 100644
--- a/src/bin/dwarfdump/CMakeLists.txt
+++ b/src/bin/dwarfdump/CMakeLists.txt
@@ -65,7 +65,7 @@ target_compile_options(dwarfdump PRIVATE ${DW_FWALL})

 target_link_libraries(dwarfdump PRIVATE ${dwarf-target} ${DW_FZLIB} ${DW_FZSTD} )

-if(${CMAKE_SIZEOF_VOID_P} EQUAL 8)
+if(0)
 	set(SUFFIX 64)
 endif()
 set(LIBDIR lib${SUFFIX})
diff --git a/src/lib/libdwarf/CMakeLists.txt b/src/lib/libdwarf/CMakeLists.txt
index 09908bba..38a73d9a 100644
--- a/src/lib/libdwarf/CMakeLists.txt
+++ b/src/lib/libdwarf/CMakeLists.txt
@@ -96,8 +96,7 @@ if (DW_FZSTD)
 endif()
 foreach(i RANGE ${targetCount})
 	list(GET DWARF_TARGETS ${i} target)
-	list(GET DWARF_TYPES ${i} type)
-	add_library(${target} ${type} ${SOURCES} ${HEADERS}
+	add_library(${target} ${DWARF_TYPES} ${SOURCES} ${HEADERS}
             ${GENNAMES_OUTPUT} ${CONFIGURATION_FILES})

 	set_folder(${target} src/lib/libdwarf)
@@ -109,7 +108,6 @@ foreach(i RANGE ${targetCount})

 	set_target_properties(${target} PROPERTIES OUTPUT_NAME dwarf)

-	set(SUFFIX $<$<EQUAL:${CMAKE_SIZEOF_VOID_P},8>:64>)
 	set(LIBDIR lib${SUFFIX})
 	set(BINDIR bin${SUFFIX})

diff --git a/src/lib/libdwarf/libdwarf_private.h b/src/lib/libdwarf/libdwarf_private.h
index b37ae994..7fa89256 100644
--- a/src/lib/libdwarf/libdwarf_private.h
+++ b/src/lib/libdwarf/libdwarf_private.h
@@ -26,11 +26,7 @@
 #ifdef _MSC_VER /* Macro to select VS compiler */
 #include <windows.h>
 typedef SSIZE_T ssize_t;
-#ifdef _WIN64
-typedef long long off_t;
-#else
 typedef long off_t;
-#endif
 #endif /* _MSC_VER */

 #ifndef TRUE

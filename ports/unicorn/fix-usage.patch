diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9574be9..2d44fc9 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -100,7 +100,7 @@ if(MSVC)
     add_compile_options($<$<COMPILE_LANGUAGE:C>:/wd4267>)
 
     # handle msvcrt setting being passed in CMAKE_C_FLAGS
-    if(DEFINED CMAKE_MSVC_RUNTIME_LIBRARY)
+    if(NOT CMAKE_MSVC_RUNTIME_LIBRARY)
         # do not support other methods of setting this (it would be more conformant, tho)
         message(FATAL_ERROR "please set msvcrt via CMAKE_C_FLAGS")
     endif()
@@ -1348,8 +1348,9 @@ else()
     )
 endif()
 
-target_include_directories(unicorn PUBLIC
-    include
+target_include_directories(unicorn PUBLIC
+    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
+    $<INSTALL_INTERFACE:include> 
 )
 
 # For static archive
@@ -1416,15 +1417,19 @@ if(UNICORN_BUILD_TESTS)
 endif()
 
 
-if(UNICORN_INSTALL AND NOT MSVC)
+if(UNICORN_INSTALL)
     include("GNUInstallDirs")
     file(GLOB UNICORN_HEADERS ${CMAKE_CURRENT_SOURCE_DIR}/include/unicorn/*.h)
     if (BUILD_SHARED_LIBS)
-        install(TARGETS unicorn
+        install(TARGETS unicorn EXPORT unofficial-unicornConfig
             RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
             ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
             LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
         )
+        install(EXPORT unofficial-unicornConfig
+        NAMESPACE unofficial::unicorn::
+        DESTINATION share/unofficial-unicorn
+    )
     endif()
     install(FILES $<TARGET_FILE:unicorn_archive> DESTINATION ${CMAKE_INSTALL_LIBDIR})
     install(FILES ${UNICORN_HEADERS} DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/unicorn)

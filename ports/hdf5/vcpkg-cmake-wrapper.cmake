_find_package(${ARGS})

if (NOT PROJECT_NAME STREQUAL "VTK")
   # Fill in missing static/shared targets
   foreach(HDF5TARGET hdf5 hdf5_hl hdf5_cpp hdf5_hl_cpp)
      if(TARGET hdf5::${HDF5TARGET}-static AND NOT TARGET hdf5::${HDF5TARGET}-shared)
            message(REMAPPING HDF5)
            _add_library(hdf5::${HDF5TARGET}-shared INTERFACE IMPORTED)
            set_target_properties(hdf5::${HDF5TARGET}-shared PROPERTIES INTERFACE_LINK_LIBRARIES "hdf5::${HDF5TARGET}-static")
      elseif(TARGET hdf5::${HDF5TARGET}-shared AND NOT TARGET hdf5::${HDF5TARGET}-static)
            message(REMAPPING HDF5)
            _add_library(hdf5::${HDF5TARGET}-static INTERFACE IMPORTED)
            set_target_properties(hdf5::${HDF5TARGET}-static PROPERTIES INTERFACE_LINK_LIBRARIES "hdf5::${HDF5TARGET}-shared")
      endif()
   endforeach()
endif()

if("@VCPKG_LIBRARY_LINKAGE@" STREQUAL "static")
   find_package(SZIP CONFIG REQUIRED)
   foreach(HDF5TARGET hdf5 hdf5_hl hdf5_cpp hdf5_hl_cpp)
      if(TARGET hdf5::${HDF5TARGET}-static)
         if (TARGET szip-shared)
            set_property(TARGET hdf5::${HDF5TARGET}-static APPEND PROPERTY INTERFACE_LINK_LIBRARIES szip-shared)
         else ()
            set_property(TARGET hdf5::${HDF5TARGET}-static APPEND PROPERTY INTERFACE_LINK_LIBRARIES szip-static)
         endif ()
       endif()
   endforeach()
endif()


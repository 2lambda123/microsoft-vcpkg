diff --git a/CMakeFilters.cmake b/CMakeFilters.cmake
index d5f801e..b8ec9d2 100644
--- a/CMakeFilters.cmake
+++ b/CMakeFilters.cmake
@@ -117,8 +117,15 @@ if (HDF5_ENABLE_SZIP_SUPPORT)
         set (LINK_COMP_LIBS ${LINK_COMP_LIBS} ${SZIP_LIBRARIES})
       endif ()
     endif ()
+  else()
+    find_package(szip CONFIG REQUIRED)
   endif ()
-  if (SZIP_FOUND)
+  string(TOUPPER ${CMAKE_BUILD_TYPE} upper_build_type)
+  if (TARGET szip-shared)
+    get_target_property(SZIP_STATIC_LIBRARY szip-shared IMPORTED_IMPLIB_${upper_build_type})
+  elseif (TARGET szip-static)
+    get_target_property(SZIP_STATIC_LIBRARY szip-static IMPORTED_IMPLIB_${upper_build_type})
+  elseif (SZIP_FOUND)
     set (H5_HAVE_FILTER_SZIP 1)
     set (H5_HAVE_SZLIB_H 1)
     set (H5_HAVE_LIBSZ 1)

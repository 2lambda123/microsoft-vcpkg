diff --git a/CMakeFilters.cmake b/CMakeFilters.cmake
index d5f801e289..5e1d7d0d37 100644
--- a/CMakeFilters.cmake
+++ b/CMakeFilters.cmake
@@ -113,7 +113,11 @@ if (HDF5_ENABLE_SZIP_SUPPORT)
     find_package (SZIP NAMES ${SZIP_PACKAGE_NAME}${HDF_PACKAGE_EXT} COMPONENTS static shared)
     if (NOT SZIP_FOUND)
       find_package (SZIP) # Legacy find
-      if (SZIP_FOUND)
+      if (DEFINED SZIP_SHARED_LIBRARY AND NOT DEFINED SZIP_STATIC_LIBRARY)
+          set (SZIP_STATIC_LIBRARY "${SZIP_SHARED_LIBRARY}")
+      elseif (DEFINED SZIP_STATIC_LIBRARY AND NOT DEFINED SZIP_SHARED_LIBRARY)
+          set (SZIP_SHARED_LIBRARY "${SZIP_STATIC_LIBRARY}")
+      elseif (SZIP_FOUND)
         set (LINK_COMP_LIBS ${LINK_COMP_LIBS} ${SZIP_LIBRARIES})
       endif ()
     endif ()

diff --git a/src/plist.c b/src/plist.c
index 0fcd926..bf4234e 100644
--- a/src/plist.c
+++ b/src/plist.c
@@ -104,6 +104,8 @@ static pthread_once_t deinit_once = PTHREAD_ONCE_INIT;
   #endif
 #endif
 
+#ifdef LIBPLIST_EXPORTS
+
 #ifdef HAVE_ATTRIBUTE_CONSTRUCTOR
 static void __attribute__((constructor)) libplist_initialize(void)
 {
@@ -133,6 +135,8 @@ BOOL WINAPI DllMain(HINSTANCE hModule, DWORD dwReason, LPVOID lpReserved)
 #warning No compiler support for constructor/destructor attributes, some features might not be available.
 #endif
 
+#endif
+
 #ifndef HAVE_MEMMEM
 // see https://sourceware.org/legacy-ml/libc-alpha/2007-12/msg00000.html
 

diff --git a/CMakeLists.txt b/CMakeLists.txt
index cf74af5..fbfdf4c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -43,6 +43,7 @@ endif()
 set(MBEDTLS_DIR ${CMAKE_CURRENT_SOURCE_DIR})
 
 option(ENABLE_PROGRAMS "Build mbed TLS programs." ON)
+option(ENABLE_PTHREAD "Build mbed TLS with pthread" OFF)
 
 option(UNSAFE_BUILD "Allow unsafe builds. These builds ARE NOT SECURE." OFF)
 option(MBEDTLS_FATAL_WARNINGS "Compiler warnings treated as errors" ON)
@@ -222,6 +223,19 @@ else()
     set(LIB_INSTALL_DIR lib)
 endif()
 
+include_directories(${CMAKE_CURRENT_BINARY_DIR}/include/)
+
+if(ENABLE_PTHREAD)
+    if(WIN32)
+        find_package(pthreads_windows REQUIRED)
+        include_directories(${PThreads4W_INCLUDE_DIR})
+    else()
+        set(CMAKE_THREAD_PREFER_PTHREAD ON)
+        find_package(Threads REQUIRED)
+    endif()
+    set(LINK_WITH_PTHREAD ON)
+endif()
+
 add_subdirectory(include)
 
 add_subdirectory(3rdparty)
diff --git a/include/mbedtls/mbedtls_config.h b/include/mbedtls/mbedtls_config.h
index a60db7e..bb2cad5 100644
--- a/include/mbedtls/mbedtls_config.h
+++ b/include/mbedtls/mbedtls_config.h
@@ -24,6 +24,11 @@
  *  limitations under the License.
  */
 
+#ifdef ENABLE_PTHREAD
+#define MBEDTLS_THREADING_C
+#define MBEDTLS_THREADING_PTHREAD
+#endif
+
 /**
  * This is an optional version symbol that enables comatibility handling of
  * config files.
diff --git a/library/CMakeLists.txt b/library/CMakeLists.txt
index 1cd5589..aa06678 100644
--- a/library/CMakeLists.txt
+++ b/library/CMakeLists.txt
@@ -130,7 +130,11 @@ if(HAIKU)
 endif(HAIKU)
 
 if(LINK_WITH_PTHREAD)
-    set(libs ${libs} pthread)
+    if(WIN32)
+        set(libs ${libs} ${PThreads4W_LIBRARY})
+    else()
+        set(libs ${libs} pthread)
+    endif()
 endif()
 
 if(LINK_WITH_TRUSTED_STORAGE)

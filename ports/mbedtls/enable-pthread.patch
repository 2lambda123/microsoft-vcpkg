diff --git a/CMakeLists.txt b/CMakeLists.txt
index 2eba16da5..5e7e242de 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -58,6 +58,7 @@ endif()
 # Set the project root directory.
 set(MBEDTLS_DIR ${CMAKE_CURRENT_SOURCE_DIR})
 
+option(ENABLE_PTHREAD "Build Mbed TLS with pthread" OFF)
 option(ENABLE_PROGRAMS "Build Mbed TLS programs." ON)
 
 option(UNSAFE_BUILD "Allow unsafe builds. These builds ARE NOT SECURE." OFF)
@@ -288,6 +289,18 @@ if (NOT EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/framework/CMakeLists.txt")
 endif()
 add_subdirectory(framework)
 
+include_directories(${CMAKE_CURRENT_BINARY_DIR}/include/)
+if(ENABLE_PTHREAD)
+    if(WIN32)
+        find_package(pthreads_windows REQUIRED)
+        include_directories(${PThreads4W_INCLUDE_DIR})
+    else()
+        set(CMAKE_THREAD_PREFER_PTHREAD ON)
+        find_package(Threads REQUIRED)
+    endif()
+    set(LINK_WITH_PTHREAD ON)
+endif()
+
 add_subdirectory(include)
 
 add_subdirectory(3rdparty)
diff --git a/include/CMakeLists.txt b/include/CMakeLists.txt
index e11e2715a..897c79785 100644
--- a/include/CMakeLists.txt
+++ b/include/CMakeLists.txt
@@ -1,10 +1,14 @@
 option(INSTALL_MBEDTLS_HEADERS "Install Mbed TLS headers." ON)
 
+configure_file(mbedtls/config_threading.h.in mbedtls/config_threading.h)
+
 if(INSTALL_MBEDTLS_HEADERS)
 
     file(GLOB headers "mbedtls/*.h")
     file(GLOB psa_headers "psa/*.h")
-
+    
+    set(headers ${headers} ${CMAKE_CURRENT_BINARY_DIR}/mbedtls/config_threading.h)
+    
     install(FILES ${headers}
         DESTINATION include/mbedtls
         PERMISSIONS OWNER_READ OWNER_WRITE GROUP_READ WORLD_READ)
diff --git a/include/mbedtls/config_threading.h.in b/include/mbedtls/config_threading.h.in
new file mode 100644
index 000000000..9d5d42ead
--- /dev/null
+++ b/include/mbedtls/config_threading.h.in
@@ -0,0 +1,6 @@
+#cmakedefine ENABLE_PTHREAD
+
+#ifdef ENABLE_PTHREAD
+#define MBEDTLS_THREADING_C
+#define MBEDTLS_THREADING_PTHREAD
+#endif
\ No newline at end of file
diff --git a/include/mbedtls/mbedtls_config.h b/include/mbedtls/mbedtls_config.h
index 35921412c..3cefab75d 100644
--- a/include/mbedtls/mbedtls_config.h
+++ b/include/mbedtls/mbedtls_config.h
@@ -20,6 +20,7 @@
  * introduced the config format we want to be compatible with.
  */
 //#define MBEDTLS_CONFIG_VERSION 0x03000000
+#include "mbedtls/config_threading.h"
 
 /**
  * \name SECTION: System support
diff --git a/library/CMakeLists.txt b/library/CMakeLists.txt
index e6705de55..09ce3bf1b 100644
--- a/library/CMakeLists.txt
+++ b/library/CMakeLists.txt
@@ -232,7 +232,11 @@ if(HAIKU)
 endif(HAIKU)
 
 if(LINK_WITH_PTHREAD)
-    set(libs ${libs} ${CMAKE_THREAD_LIBS_INIT})
+    if(WIN32)
+        set(libs ${libs} ${PThreads4W_LIBRARY})
+    else()
+        set(libs ${libs}  ${CMAKE_THREAD_LIBS_INIT})
+    endif()
 endif()
 
 if(LINK_WITH_TRUSTED_STORAGE)

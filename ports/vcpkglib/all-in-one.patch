From 2b8cb017c74f6909ce55d01774ce9fda138b64d8 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 06:23:42 +0300
Subject: [PATCH 01/12] Update CMakeLists.txt

---
 CMakeLists.txt | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 5d27c57c4..3e0f4e4f3 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -142,7 +142,7 @@ find_package(fmt REQUIRED)
 
 # === Target: vcpkglib ===
 
-add_library(vcpkglib OBJECT
+add_library(vcpkglib
     ${VCPKGLIB_BASE_SOURCES}
     ${VCPKGLIB_SOURCES}
     ${VCPKGLIB_BASE_INCLUDES}
@@ -241,6 +241,7 @@ endif()
 
 # === Target: vcpkg ===
 
+if(0)
 add_executable(vcpkg ${VCPKG_SOURCES})
 target_link_libraries(vcpkg PRIVATE vcpkglib)
 vcpkg_target_add_warning_options(vcpkg)
@@ -256,6 +257,7 @@ endif()
 if(VCPKG_PDB_SUFFIX)
     set_property(TARGET vcpkg PROPERTY PDB_NAME "vcpkg${VCPKG_PDB_SUFFIX}")
 endif()
+endif()
 
 # === Target: generate-message-map ===
 
@@ -338,7 +340,5 @@ endif()
 # === Installation ===
 # ====================
 
-install(TARGETS vcpkg
-    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
-    BUNDLE DESTINATION ${CMAKE_INSTALL_BINDIR}
-)
+set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER ${VCPKGLIB_BASE_INCLUDES} ${VCPKGLIB_INCLUDES})
+install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib PUBLIC_HEADER DESTINATION include)

From 32dabe92751a92f33b1be5abad2a3522cc296478 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 06:29:56 +0300
Subject: [PATCH 02/12] Update CMakeLists.txt

---
 CMakeLists.txt | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 3e0f4e4f3..b95f557e6 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -340,5 +340,6 @@ endif()
 # === Installation ===
 # ====================
 
-set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER ${VCPKGLIB_BASE_INCLUDES} ${VCPKGLIB_INCLUDES})
+list(APPEND VCPKGLIB_INCLUDES ${VCPKGLIB_BASE_INCLUDES})
+set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER ${VCPKGLIB_INCLUDES})
 install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib PUBLIC_HEADER DESTINATION include)

From a45ffc1aec5a1a5c70a0965b74408847fb3e8e10 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 06:32:42 +0300
Subject: [PATCH 03/12] Update CMakeLists.txt

---
 CMakeLists.txt | 1 +
 1 file changed, 1 insertion(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index b95f557e6..fe73b408a 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -341,5 +341,6 @@ endif()
 # ====================
 
 list(APPEND VCPKGLIB_INCLUDES ${VCPKGLIB_BASE_INCLUDES})
+message(STATUS "kek ${VCPKGLIB_INCLUDES}")
 set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER ${VCPKGLIB_INCLUDES})
 install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib PUBLIC_HEADER DESTINATION include)

From bfc634d977ebca3ee17b4beb58c8176270385a6a Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 06:35:10 +0300
Subject: [PATCH 04/12] Update CMakeLists.txt

---
 CMakeLists.txt | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index fe73b408a..59ffe0076 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -341,6 +341,5 @@ endif()
 # ====================
 
 list(APPEND VCPKGLIB_INCLUDES ${VCPKGLIB_BASE_INCLUDES})
-message(STATUS "kek ${VCPKGLIB_INCLUDES}")
-set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER ${VCPKGLIB_INCLUDES})
+set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER "${VCPKGLIB_INCLUDES}")
 install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib PUBLIC_HEADER DESTINATION include)

From 42a1115b27cb77c1a42afaef917d1534205fa075 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 06:58:16 +0300
Subject: [PATCH 05/12] Update CMakeLists.txt

---
 CMakeLists.txt | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 59ffe0076..00aca9e4b 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -340,6 +340,11 @@ endif()
 # === Installation ===
 # ====================
 
-list(APPEND VCPKGLIB_INCLUDES ${VCPKGLIB_BASE_INCLUDES})
-set_target_properties(vcpkglib PROPERTIES PUBLIC_HEADER "${VCPKGLIB_INCLUDES}")
-install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib PUBLIC_HEADER DESTINATION include)
+# install directory instead of using PUBLIC_HEADER to maintain directory heirarchy
+install(DIRECTORY "${CMAKE_SOURCE_DIR}/"
+    DESTINATION "include/vcpkg"
+    FILES_MATCHING
+    PATTERN "include/vcpkg/*.h" "include/vcpkg/fwd/*.h" "include/vcpkg/base/*.h" "include/vcpkg/base/fwd/*.h"
+)
+
+install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)

From 5b7b42f910d2025d1e7a44a78959f9c009058be9 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 07:00:24 +0300
Subject: [PATCH 06/12] Update CMakeLists.txt

---
 CMakeLists.txt | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 00aca9e4b..9a21dfc4a 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -344,7 +344,10 @@ endif()
 install(DIRECTORY "${CMAKE_SOURCE_DIR}/"
     DESTINATION "include/vcpkg"
     FILES_MATCHING
-    PATTERN "include/vcpkg/*.h" "include/vcpkg/fwd/*.h" "include/vcpkg/base/*.h" "include/vcpkg/base/fwd/*.h"
+    PATTERN "include/vcpkg/*.h" 
+    PATTERN "include/vcpkg/fwd/*.h" 
+    PATTERN "include/vcpkg/base/*.h" 
+    PATTERN "include/vcpkg/base/fwd/*.h"
 )
 
 install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)

From d863547f3a4ebee661527ff62204195b4804cd5c Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 07:05:00 +0300
Subject: [PATCH 07/12] Update CMakeLists.txt

---
 CMakeLists.txt | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9a21dfc4a..67a10ddc5 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -341,13 +341,13 @@ endif()
 # ====================
 
 # install directory instead of using PUBLIC_HEADER to maintain directory heirarchy
-install(DIRECTORY "${CMAKE_SOURCE_DIR}/"
+install(DIRECTORY "${CMAKE_SOURCE_DIR}/include/vcpkg"
     DESTINATION "include/vcpkg"
     FILES_MATCHING
-    PATTERN "include/vcpkg/*.h" 
-    PATTERN "include/vcpkg/fwd/*.h" 
-    PATTERN "include/vcpkg/base/*.h" 
-    PATTERN "include/vcpkg/base/fwd/*.h"
+    PATTERN "*.h" 
+    PATTERN "fwd/*.h" 
+    PATTERN "base/*.h" 
+    PATTERN "base/fwd/*.h"
 )
 
 install(TARGETS vcpkglib RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)

From 4159b466398f1059fca18200a5fc70c8066998b4 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 07:07:41 +0300
Subject: [PATCH 08/12] Update CMakeLists.txt

---
 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 67a10ddc5..b18f8c036 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -342,7 +342,7 @@ endif()
 
 # install directory instead of using PUBLIC_HEADER to maintain directory heirarchy
 install(DIRECTORY "${CMAKE_SOURCE_DIR}/include/vcpkg"
-    DESTINATION "include/vcpkg"
+    DESTINATION "include"
     FILES_MATCHING
     PATTERN "*.h" 
     PATTERN "fwd/*.h" 

From 5b76ef8338e3271e644c7371e8f021a2eb078d06 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 07:17:48 +0300
Subject: [PATCH 09/12] Update CMakeLists.txt

---
 CMakeLists.txt | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index b18f8c036..44c9c5d61 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -150,6 +150,10 @@ add_library(vcpkglib
 )
 target_include_directories(vcpkglib PUBLIC include)
 
+# vcpkg wasn't intended to be used as a library so it obviously doesn't export anything
+# exporting everything by settings WINDOWS_EXPORT_ALL_SYMBOLS to ON then
+set_target_properties(vcpkglib PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS ON)
+
 vcpkg_target_add_warning_options(vcpkglib)
 target_compile_definitions(vcpkglib PUBLIC
     VCPKG_VERSION=${VCPKG_VERSION}

From 044d51ebb297478725baf5e4ba12738b7288945f Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 07:50:23 +0300
Subject: [PATCH 10/12] Delete Findfmt.cmake

---
 cmake/Findfmt.cmake | 19 -------------------
 1 file changed, 19 deletions(-)
 delete mode 100644 cmake/Findfmt.cmake

diff --git a/cmake/Findfmt.cmake b/cmake/Findfmt.cmake
deleted file mode 100644
index 9a188c265..000000000
--- a/cmake/Findfmt.cmake
+++ /dev/null
@@ -1,19 +0,0 @@
-option(VCPKG_DEPENDENCY_EXTERNAL_FMT "Use an external version of the fmt library" OFF)
-set(VCPKG_FMT_URL "https://github.com/fmtlib/fmt/archive/refs/tags/8.1.1.tar.gz" CACHE STRING "URL to the fmt release tarball to use.")
-
-include(FetchContent)
-FetchContent_Declare(
-    fmt
-    URL "${VCPKG_FMT_URL}"
-    URL_HASH SHA512=794a47d7cb352a2a9f2c050a60a46b002e4157e5ad23e15a5afc668e852b1e1847aeee3cda79e266c789ff79310d792060c94976ceef6352e322d60b94e23189
-)
-
-if(NOT fmt_FIND_REQUIRED)
-    message(FATAL_ERROR "fmt must be REQUIRED")
-endif()
-
-if(VCPKG_DEPENDENCY_EXTERNAL_FMT)
-    find_package(fmt CONFIG REQUIRED)
-else()
-    FetchContent_MakeAvailable(fmt)
-endif()

From 6786e2bc1d9ae65b92902115dd6f0a6ecfce9791 Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 08:10:10 +0300
Subject: [PATCH 11/12] Update CMakeLists.txt

---
 CMakeLists.txt | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 44c9c5d61..b18f8c036 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -150,10 +150,6 @@ add_library(vcpkglib
 )
 target_include_directories(vcpkglib PUBLIC include)
 
-# vcpkg wasn't intended to be used as a library so it obviously doesn't export anything
-# exporting everything by settings WINDOWS_EXPORT_ALL_SYMBOLS to ON then
-set_target_properties(vcpkglib PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS ON)
-
 vcpkg_target_add_warning_options(vcpkglib)
 target_compile_definitions(vcpkglib PUBLIC
     VCPKG_VERSION=${VCPKG_VERSION}

From ef0c27e7dc1adcf64908bb94101ea8bb902bae5c Mon Sep 17 00:00:00 2001
From: Leonid Pospelov <pospelovlm@yandex.ru>
Date: Sun, 24 Apr 2022 08:11:03 +0300
Subject: [PATCH 12/12] Update CMakeLists.txt

---
 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index b18f8c036..7f37e5b5d 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -142,7 +142,7 @@ find_package(fmt REQUIRED)
 
 # === Target: vcpkglib ===
 
-add_library(vcpkglib
+add_library(vcpkglib STATIC
     ${VCPKGLIB_BASE_SOURCES}
     ${VCPKGLIB_SOURCES}
     ${VCPKGLIB_BASE_INCLUDES}

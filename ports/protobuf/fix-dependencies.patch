diff --git a/cmake/install.cmake b/cmake/install.cmake
index 52d0745..e7c22dd 100644
--- a/cmake/install.cmake
+++ b/cmake/install.cmake
@@ -68,7 +68,6 @@ set(protobuf_HEADERS
   ${cpp_features_proto_proto_srcs}
   ${descriptor_proto_proto_srcs}
   ${plugin_proto_proto_srcs}
-  ${java_features_proto_proto_srcs}
 )
 foreach(_header ${protobuf_HEADERS})
   string(FIND ${_header} "${protobuf_SOURCE_DIR}/src" _find_src)
diff --git a/cmake/libprotobuf-lite.cmake b/cmake/libprotobuf-lite.cmake
index f343458..6ceb27a 100644
--- a/cmake/libprotobuf-lite.cmake
+++ b/cmake/libprotobuf-lite.cmake
@@ -42,4 +42,4 @@ set_target_properties(libprotobuf-lite PROPERTIES
 )
 add_library(protobuf::libprotobuf-lite ALIAS libprotobuf-lite)
 
-target_link_libraries(libprotobuf-lite PRIVATE utf8_validity)
+target_link_libraries(libprotobuf-lite PRIVATE utf8_range::utf8_range utf8_range::utf8_validity)
diff --git a/cmake/libprotobuf.cmake b/cmake/libprotobuf.cmake
index 422754a..f1ba8b9 100644
--- a/cmake/libprotobuf.cmake
+++ b/cmake/libprotobuf.cmake
@@ -45,4 +45,4 @@ set_target_properties(libprotobuf PROPERTIES
 )
 add_library(protobuf::libprotobuf ALIAS libprotobuf)
 
-target_link_libraries(libprotobuf PRIVATE utf8_validity)
+target_link_libraries(libprotobuf PRIVATE utf8_range::utf8_range utf8_range::utf8_validity)
diff --git a/cmake/utf8_range.cmake b/cmake/utf8_range.cmake
index f411a8c..d67f3a7 100644
--- a/cmake/utf8_range.cmake
+++ b/cmake/utf8_range.cmake
@@ -1,4 +1,4 @@
-if (NOT TARGET utf8_range)
+if (0)
   set(utf8_range_ENABLE_TESTS OFF CACHE BOOL "Disable utf8_range tests")
 
   if (NOT EXISTS "${protobuf_SOURCE_DIR}/third_party/utf8_range/CMakeLists.txt")
@@ -11,5 +11,5 @@ if (NOT TARGET utf8_range)
   add_subdirectory(${CMAKE_CURRENT_SOURCE_DIR}/third_party/utf8_range third_party/utf8_range)
   include_directories(${CMAKE_CURRENT_SOURCE_DIR}/third_party/utf8_range)
 endif ()
-
+find_package(utf8_range CONFIG REQUIRED)
 set(_protobuf_FIND_UTF8_RANGE "if(NOT TARGET utf8_range)\n  find_package(utf8_range CONFIG)\nendif()")

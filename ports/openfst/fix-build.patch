diff --git a/CMakeLists.txt b/CMakeLists.txt
index f6189db..8457084 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,5 +1,7 @@
 project(openfst)
+if(BUILD_UNIT_TESTS)
 include(CTest)
+endif()
 find_package(ICU COMPONENTS data i18n io  test tu uc)
 if (ICU_FOUND)
   include_directories(${ICU_INCLUDE_DIRS})
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index acc4bf1..00283d7 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -6,13 +6,21 @@ install(DIRECTORY include/ DESTINATION include/
         FILES_MATCHING PATTERN "*.h")
 
 add_subdirectory(lib)
+if(BUILD_TOOLS)
 add_subdirectory(script)
+endif()
 
 if(HAVE_BIN)
+if(BUILD_TOOLS)
   add_subdirectory(bin)
+endif()
 endif(HAVE_BIN)
 
+if(BUILD_TOOLS)
 add_subdirectory(extensions)
+endif()
 
+if(BUILD_UNIT_TESTS)
 enable_testing()
 add_subdirectory(test)
+endif()
diff --git a/src/lib/CMakeLists.txt b/src/lib/CMakeLists.txt
index c004aee..eff17ed 100644
--- a/src/lib/CMakeLists.txt
+++ b/src/lib/CMakeLists.txt
@@ -1,7 +1,10 @@
 FILE(GLOB HEADER_FILES ../include/fst/*.h)
 
+include(CMakePackageConfigHelpers)
+include(GNUInstallDirs)
 
-add_library(fst
+if (BUILD_SHARED_LIBS)
+add_library(fst SHARED
   compat.cc
   flags.cc
   fst-types.cc
@@ -14,13 +17,51 @@ add_library(fst
   weight.cc
   ${HEADER_FILES}
 )
+else()
+add_library(fst STATIC
+  compat.cc
+  flags.cc
+  fst-types.cc
+  fst.cc
+  mapped-file.cc
+  properties.cc
+  symbol-table.cc
+  symbol-table-ops.cc
+  util.cc
+  weight.cc
+  ${HEADER_FILES}
+)
+endif()
+
 set_target_properties(fst PROPERTIES
   SOVERSION "${SOVERSION}"
 )
 
+if (BUILD_SHARED_LIBS)
+install(TARGETS fst EXPORT openfstTargets
+        RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
+        LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
+        ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
+        )
+else()
+install(TARGETS fst EXPORT openfstTargets
+        RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
+        LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
+        ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
+        )
+endif()
 
+file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/openfst-config.cmake"
+[[include(CMakeFindDependencyMacro)
+file(GLOB TARGET_FILES "${CMAKE_CURRENT_LIST_DIR}/openfstTargets.cmake")
+foreach (TARGET_FILE ${TARGET_FILES})
+    include("${TARGET_FILE}")
+endforeach()
+]])
+install(FILES "${CMAKE_CURRENT_BINARY_DIR}/openfst-config.cmake" DESTINATION share/openfst)
 
-install(TARGETS fst
-  LIBRARY DESTINATION lib
-  ARCHIVE DESTINATION lib
-  RUNTIME DESTINATION lib)
+install(DIRECTORY ../include/fst DESTINATION ${CMAKE_INSTALL_INCLUDEDIR})
+install(EXPORT openfstTargets
+    NAMESPACE openfst::
+    DESTINATION share/openfst
+)
